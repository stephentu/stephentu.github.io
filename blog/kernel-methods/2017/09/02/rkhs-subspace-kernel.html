<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>stephentu's blog - Random assortment of things</title>
<meta name="description" content="stephentu's blog" />
<style type="text/css">
.post-dates{display:inline;padding-right:10px}
.post-desc{font-style:italic}
.post-footer{font-style:italic}
body{margin:40px auto;max-width:800px;line-height:1.6;font-size:18px;color:#444;padding:0 10px}
h1,h2,h3{line-height:1.2}
</style>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}, 
        TeX: {equationNumbers: {autoNumber: "AMS"}}
    });
</script>
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<h2>RKHS Defined on Subspaces</h2>
<div class="post-desc"> 
02 Sep 2017
 
on kernel-methods 

</div>
<div class="post-content">
<p>
This is a neat calculation that was pointed out to me by Vikas Sindhwani.
The exposition here is from the 
book <a href="https://link.springer.com/book/10.1007%2F978-1-4419-9096-9">Reproducing Kernel Hilbert Spaces in Probability and Statistics</a>.
$
\newcommand{\abs}[1]{| #1 |}
\newcommand{\ind}{\mathbf{1}}
\newcommand{\norm}[1]{\lVert #1 \rVert}
\newcommand{\ip}[2]{\langle #1, #2 \rangle}
\newcommand{\R}{\mathbb{R}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\T}{\mathsf{T}}
\newcommand{\Proj}{\mathcal{P}}
\newcommand{\Tr}{\mathrm{Tr}}
\newcommand{\A}{\mathcal{A}}
$
</p>

<p>
Let $\mathcal{H}$ be a reproducing kernel Hilbert space (RHKS) of functions
$f : X \longrightarrow \R$
generated by a positive-definite kernel $k : X \times X \longrightarrow \R$.
For a fixed $x \in X$ with $k(x, x) \neq 0$, 
define the subspace $\mathcal{H}_x \subseteq \mathcal{H}$
as
$$
    \mathcal{H}_x := \{ f \in \mathcal{H} : \ip{k_x}{f} = f(x) = 0 \} \:.
$$
Of course, $\mathcal{H}_x$ is itself a RKHS.
What is its associated kernel $k_x$?
</p>

<p>
More generally, for a $\phi \in \mathcal{H}$ with
$\norm{\phi} = 1$, consider the one-dimensional subspace
$$
    \mathcal{H}_\phi = \mathrm{span}\{ \phi \} \:.
$$
</p>

<p>
<strong>Lemma:</strong>
The reproducing kernel of $\mathcal{H}_\phi$ is
$(x, y) \mapsto \phi(x)\phi(y)$.</p>

<p>
<i>Proof</i>:
We do this by checking the properties of a reproducing kernel.
For any $x \in X$, we have $\phi(x) \phi(\cdot) \in \mathcal{H}_\phi$.
Now, let $f \in \mathcal{H}_\phi$ and $x \in X$.
By definition, we can write $f = \alpha \phi$ for some $\alpha \in \R$.
On the other hand,
$$
    \ip{f}{ \phi(x)\phi} = \ip{\alpha \phi}{\phi(x) \phi} = \alpha \phi(x) \norm{\phi}^2 = \alpha \phi(x) = f(x) \:.
$$
And hence, the reproducing property is satisfied. $\square$
</p>

<p>
We can now describe the reproducing kernel for
$\mathcal{H}_x^\perp$. We have that
$$
    \mathcal{H}_x^\perp = \mathrm{span}\{ k_x/\norm{k_x} \} \:.
$$
Also, recall that by the reproducing property,
$$
    \norm{k_x}^2 = \ip{k_x}{k_x} = k(x, x) \:.
$$
Hence, applying the above lemma, the reproducing kernel for $\mathcal{H}_x^\perp$ is
$$
    (s, t) \mapsto k(s, x) k(x, x)^{-1} k(x, t) \:.
$$
</p>

<p>
We now state a composition rule of reproducing kernels.
</p>

<p>
<strong>Lemma:</strong>
Let $\mathcal{H} = S \oplus S^\perp$, where $S,S^\perp$ are RKHSes with
kernels $k_1, k_2$. The reproducing kernel for $\mathcal{H}$ is $k = k_1 + k_2$.
</p>

<p>
<i>Proof:</i>
Let $f \in \mathcal{H}$. By the orthogonal decomposition, we have that
$f = f_1 + f_2$, where $f_1 \in S$ and $f_2 \in S^\perp$.
Fix an $x \in X$.
We have that $k(x, \cdot) = k_1(x, \cdot) + k_2(x, \cdot) \in \mathcal{H}$.
Furthermore,
$$
\begin{align*}
  \ip{f}{k(x, \cdot)} &= \ip{f}{k_1(x, \cdot)} + \ip{f}{k_2(x, \cdot)} \\
  &= \ip{f_1}{k_1(x, \cdot)} + \ip{f_2}{k_2(x, \cdot)} \\
  &= f_1(x) + f_2(x) \\
  &= f(x) \:.
\end{align*}
$$
Above, the second equality uses the orthogonal decomposition.
Hence, $k$ satisfies the reproducing property. $\square$
</p>

<p>
From this lemma, we conclude that the reproducing kernel of $\mathcal{H}_x$ is
$$
    (s, t) = k(s, t) - k(s, x) k(x, x)^{-1} k(x, t) \:.
$$
</p>

</div>
<div class="post-footer">
<a href="/blog/">Home</a>
</div>

</body>
</html>
